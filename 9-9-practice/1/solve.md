# Nim游戏
## 问题描述
地上有 $n$ 堆石子（每堆石子数量小于 $10^4$），每人每次可从任意一堆石子里取出任意多枚石子扔掉，可以取完，不能不取。每次只能从一堆里取。最后没石子可取的人就输了。求先手是否必胜
## 特点
属于博弈论中公平组合游戏，该游戏有如下特征:  
1. 游戏有两个人参与，双方轮流做出决策，且均知道游戏的完整信息
2. 任意一方在某一确定状态可以做出的决策集合只与当前状态有关，而与游戏者无关
3. 游戏中的同一状态不可能多次抵达，游戏以玩家无法行动为结束，且游戏一定会在有限步后以非平局结束
## 结论
若初态为必胜态($a_{1} \oplus a_{2} \dots \oplus a_{n} \neq 0$)，则先手必胜  
若初态为必败态($a_{1} \oplus a_{2} \dots \oplus a_{n} = 0$)，则先手必败  
(注: $a_{1}, a_{2} \dots a_{n}$表示题目中各石子堆总石子的数量)
## 定理
1. 必胜态的后继状态至少存在一个必败态
2. 必败态的后续状态均为必胜态
## 算法思路
1. 动态规划 -> X
   时间复杂度过高(O($\Pi a_{i}$))
2. 归纳递推
   首先，状态$[a, 0, 0, ..., 0]$为必胜状态，此时只需将第一堆中所有石子全部拿出即可获取胜利。
   其次，状态$[a, a, 0, ..., 0]$为必败状态，此时无论执行任何操作，对方只需对称的做出操作，对方即可获取胜利。反之，状态$[a, b, 0, ..., 0](a \neq b)$为必胜状态，使a和b中石子数量相同即可获取胜利。
   --> 由此推测  
   $a_{1} \oplus a_{2} \dots \oplus a_{n} \neq 0$为必胜态  
   $a_{1} \oplus a_{2} \dots \oplus a_{n} = 0$为必败态  
   证明如下:  
   对于$a_{1} \oplus a_{2} \dots \oplus a_{n} = S (S \neq 0)$, S必定形如*001xxx*，假设S的第k位为1，则一定有奇数个$a_{i}$在第k位为1，从中任取一个$a_{i}$，将其数量从$a_{i}$变为$a_{i} \oplus S (a_{i} \oplus S < a)$，则状态序列由${a_{1}, a_{2} \dots a_{i} \dots a_{n}}$变为${a_{1}, a_{2} \dots (a_{i} \oplus S) \dots a_{n}}$，将新状态序列异或计算,
   $$
   \begin{aligned}
   & \quad a_{1} \oplus a_{2} \dots \oplus (a_{i} \oplus S) \dots  \oplus a_{n}\\ 
   & = a_{1} \oplus a_{2} \dots \oplus a_{i} \dots  \oplus a_{n} \oplus S\\ 
   & = S \oplus S\\ 
   & = 0
   \end{aligned}
   $$
   在必败态状态下，对任意石子堆进行操作皆是在0基础上与非0数作异或操作，其结果必定不等于0，由此得证。